<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>classes/shopHotspot.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ShopHotspot.html">ShopHotspot</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopHotspot.html#.animatePanel">animatePanel</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopHotspot.html#.animateProduct">animateProduct</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopHotspot.html#.animateProductOff">animateProductOff</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopHotspot.html#.animateProductOn">animateProductOn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopHotspot.html#.checkPanel">checkPanel</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopHotspot.html#.checkPolarity">checkPolarity</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopHotspot.html#.checkProduct">checkProduct</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopHotspot.html#.generate">generate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopHotspot.html#.parse">parse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopHotspot.html#.populate">populate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopHotspot.html#.updatePanel">updatePanel</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ShopPanel.html">ShopPanel</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopPanel.html#.checkClose">checkClose</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopPanel.html#.checkCta">checkCta</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopPanel.html#.checkPanel">checkPanel</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopPanel.html#.checkPolarity">checkPolarity</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopPanel.html#.handleClose">handleClose</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopPanel.html#.handleCta">handleCta</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopPanel.html#.handler">handler</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopPanel.html#.resolveClose">resolveClose</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ShopPanel.html#.resolveCta">resolveCta</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-modules_app.html">modules/app</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-modules_app.html#~clickThroughConfig">clickThroughConfig</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-modules_app.html#~clickThroughLink">clickThroughLink</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-modules_app.html#~flexFontInit">flexFontInit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-modules_app.html#~flexFontRefresh">flexFontRefresh</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-modules_app.html#~initialize">initialize</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-modules_app.html#~preloadImages">preloadImages</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-StateGlobal.html">StateGlobal</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">classes/shopHotspot.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import TypeIt from 'typeit';
import StateGlobal from '../states/state.global';
import StateHotspots from '../data/hotspots.json';

export default class ShopHotspot {
  /**
   * The ShopHotspot Class.
   * Property (constructor) in ShopHotspot which creates the class object. This module manages the ShopHotspot logic. This module requires the modules {@link module:StateGlobal} {@link module:TypeIt}.
   * @classdesc This is a description of the ShopHotspot class.
   * @member {Function} ShopHotspot
   * @access public
   * @constructs
   * @requires module:StateGlobal
   * @requires module:TypeIt
   * @param {null} None no parameter
   * @example
   * new ShopHotspot()
   * @returns {Class} ShopHotspot
   * @throws will never throw an error.
   * @property {object}  ShopHotspot.state        						- ShopHotspot state object
   * @property {number}  ShopHotspot.state.initDrawDelay      - ShopHotspot init Draw Delay
   * @property {number}  ShopHotspot.state.cycleDelay        	- ShopHotspot cycle Delay
   * @property {number}  ShopHotspot.state.cycleDuration      - ShopHotspot cycle Duration
   * @property {number}  ShopHotspot.state.panelDisplayDelay  - ShopHotspot panel Display Delay
   * @property {object}  ShopHotspot.state.hooks        			- ShopHotspot DOM elements
   * @property {element}  ShopHotspot.state.hooks.panel       	- DOM element for shopHotspot panel
   * @property {element}  ShopHotspot.state.hooks.product    		- DOM element for shopHotspot product element
   * @property {element}  ShopHotspot.state.hooks.description 	- DOM element for shopHotspot product description
   * @property {element}  ShopHotspot.state.hooks.brand       	- DOM element for shopHotspot product brand
   * @property {element}  ShopHotspot.state.hooks.price       	- DOM element for shopHotspot product price
   * @property {element}  ShopHotspot.state.hooks.sale       		- DOM element for shopHotspot product price sale attribute
   * @property {element}  ShopHotspot.state.hooks.link       		- DOM element for shopHotspot link
   * @author Alex Reid &lt;https://github.com/aareid10>
   * @see {@link http://github.com|https://code.espn.com/CreativeWorks-Internal/creativeworks-templates/tree/master/ads/vertical-shoppable-banner|GitHub Repo}
   * @since 1.0.0
   */
  constructor() {
    this.state = {};
    this.state.initDrawDelay = StateGlobal.timing.initDrawDelay;
    this.state.cycleDelay = window.cycleDelay || StateGlobal.timing.cycleDelay;
    this.state.cycleDuration = window.cycleDuration || StateGlobal.timing.cycleDuration;
    this.state.panelDisplayDelay = window.panelDisplayDelay || StateGlobal.timing.panelDisplayDelay;
    this.state.panelTypeDelay = window.panelTypeDelay || StateGlobal.timing.panelTypeDelay;
    this.state.productOpenDelay = window.productOpenDelay || StateGlobal.timing.productOpenDelay;
    this.state.productResolveDelay = window.productResolveDelay || StateGlobal.timing.productResolveDelay;
    this.state.hotspotList = window.hotspotsURL || window.hotspots || StateHotspots;
    this.state.hooks = {
      panel: document.querySelector('#shop__panel'),
      product: document.querySelector('#shop__panel_product'),
      description: document.querySelector('#shop__panel_description'),
      brand: document.querySelector('#shop__panel_brand'),
      price: document.querySelector('#shop__panel_pricing #price'),
      sale: document.querySelector('#shop__panel_pricing #sale'),
      link: document.querySelector('#shop__panel_cta a')
    };
  }

  /**
   * Property (parse) in ShopHotspot which parses the hotspot data from a variety of sources. This will get data from a remote URL, a global object, or an embedded object within the source.
   * @function parse
   * @memberof ShopHotspot
   * @access public
   * @param {Class} ShopHotspot
   * @example
   * ShopHotspot.parse()
   * @returns {Class} ShopHotspot
   */
  parse() {
    switch (true) {
      case typeof this.state.hotspotList === 'string':
        fetch(this.state.hotspotList)
          .then(response => response.json())
          .then(records => {
            this.state.hotspotList = records;
          });
        break;
      default:
    }
    return this;
  }

  /**
   * Property (populate) in ShopHotspot which populates hotspots into the DOM based on the parsed hotspot data.
   * @function populate
   * @memberof ShopHotspot
   * @access public
   * @param {Class} ShopHotspot
   * @example
   * ShopHotspot.populate()
   * @returns {Class} ShopHotspot
   * @throws will never throw an error.
   * @since 1.0.0
   */
  populate() {
    this.state.hotspotList.hotspots.map((hotspot, index) => {
      setTimeout(() => {
        this.generate(
          'hotspot',
          `hotspot${index}`,
          hotspot.id,
          hotspot.polarity,
          hotspot.styles,
          hotspot.image,
          hotspot.url,
          JSON.stringify(hotspot.meta)
        );
      }, hotspot.pulseRate * Math.floor(Math.random() * this.state.hotspotList.hotspots.length));
    });
    return this;
  }

  /**
   * Property (generate) in ShopHotspot which generates the inner-workings and respective logic of each hotspot.
   * @function generate
   * @memberof ShopHotspot
   * @access public
   * @param {Class} ShopHotspot
   * @example
   * ShopHotspot.generate('hotspot', hotspot${index}`, hotspot.id, hotspot.polarity, hotspot.styles, hotspot.image, hotspot.url, JSON.stringify(hotspot.meta))
   * @returns {null} no return value
   * @throws will never throw an error.
   * @since 1.0.0
   */
  generate(className, id, key, polarity, style, image, url, meta) {
    const hotspot = document.createElement('div');
    hotspot.className = className;
    hotspot.id = id;
    hotspot.key = key;
    hotspot.dataset.image = image;
    hotspot.dataset.url = url;
    hotspot.dataset.meta = meta;
    hotspot.dataset.polarity = polarity;
    hotspot.onclick = (event, self = this) => {
      meta = JSON.parse(hotspot.dataset.meta);
      self.state.hooks.link.href = hotspot.dataset.url;
      self.state.hooks.product.alt = [hotspot.dataset.image.match(/[a-z]+.png/g)];
      self.state.hooks.product.src = hotspot.dataset.image;
      self.state.hooks.brand.innerText = meta.brand;
      self.state.hooks.price.innerText = meta.price;
      self.state.hooks.sale.innerText = meta.sale ? 'Sale' : '';
      this.animatePanel(hotspot);
      this.animateProduct();
    };
    Object.keys(style).map(rule => (hotspot.style[`${rule}`] = style[`${rule}`]));
    document.querySelector('#shop__hotspots').appendChild(hotspot);
  }

  /**
   * Property (checkPanel) in ShopHotspot which checks if the panel is open.
   * @function checkPanel
   * @memberof ShopHotspot
   * @access public
   * @param {null} None
   * @example
   * ShopHotspot.
   * @returns {Boolean} returns boolean
   * @throws will never throw an error.
   * @since 1.0.0
   */
  checkPanel() {
    return this.state.hooks.panel.className.match('open') === null;
  }

  /**
   * Property (checkProduct) in ShopHotspot which checks to if the product has been shown.
   * @function checkProduct
   * @memberof ShopHotspot
   * @access public
   * @param {null} None no parameter
   * @example
   * ShopHotspot.checkProduct()
   * @returns {Boolean} returns boolean
   * @throws will never throw an error.
   * @since 1.0.0
   */
  checkProduct() {
    return this.state.hooks.panel.className === 'opened';
  }

  /**
   * Property (checkPolarity) in ShopHotspot which checks the polarity of the hotspot.
   * @function checkPolarity
   * @memberof ShopHotspot
   * @access public
   * @param {Object} hotspot hotspot data object
   * @example
   * ShopHotspot.checkPolarity()
   * @returns {Boolean} returns boolean
   * @throws will never throw an error.
   * @since 1.0.0
   */
  checkPolarity(hotspot) {
    return hotspot.dataset.polarity === 'bot';
  }

  /**
   * Property (animatePanel) in ShopHotspot which triggers the panel animation.
   * @function animatePanel
   * @memberof ShopHotspot
   * @access public
   * @param {Object} hotspot hotspot data object
   * @example
   * ShopHotspot.animatePanel()
   * @returns {null} no return value
   * @throws will never throw an error.
   * @since 1.0.0
   */
  animatePanel(hotspot) {
    setTimeout(this.updatePanel(hotspot), this.state.panelDisplayDelay);
    new TypeIt('#shop__panel_description', {
      strings: [JSON.parse(hotspot.dataset.meta).description],
      speed: 10,
      loop: false,
      cursor: false,
      startDelay: this.state.panelTypeDelay
    }).go();
  }

  /**
   * Property (animateProduct) in ShopHotspot which triggers the product animation.
   * @function animateProduct
   * @memberof ShopHotspot
   * @access public
   * @param {null} None no parameter
   * @example
   * ShopHotspot.animateProduct()
   * @returns {null} no return value
   * @throws will never throw an error.
   * @since 1.0.0
   */
  animateProduct() {
    switch (this.checkProduct()) {
      case true:
        this.animateProductOn();
        break;
      case false:
        this.animateProductOff();
        break;
      default:
    }
  }

  /**
   * Property (animateProductOn) in ShopHotspot which triggers the 'ProductOn' state.
   * @function animateProductOn
   * @memberof ShopHotspot
   * @access public
   * @param {null} None no parameter
   * @example
   * ShopHotspot.animateProductOn()
   * @returns {null} no return value
   * @throws will never throw an error.
   * @since 1.0.0
   */
  animateProductOn() {
    this.state.hooks.product.className = 'closed';
    setTimeout(() => {
      this.state.hooks.product.className = 'open';
    }, this.state.productOpenDelay);
    setTimeout(() => {
      this.state.hooks.product.className += ' opened';
    }, this.state.productResolveDelay);
  }

  /**
   * Property (animateProductOff) in ShopHotspot which triggers the 'ProductOff' state.
   * @function animateProductOff
   * @memberof ShopHotspot
   * @access public
   * @param {null} None no parameter
   * @example
   * ShopHotspot.animateProductOff()
   * @returns {null} no return value
   * @throws will never throw an error.
   * @since 1.0.0
   */
  animateProductOff() {
    this.state.hooks.product.className = 'open';
    setTimeout(() => {
      this.state.hooks.product.className += ' opened';
    }, this.state.productOpenDelay);
  }

  /**
   * Property (updatePanel) in ShopHotspot which triggers the 'updatePanel' state.
   * @function updatePanel
   * @memberof ShopHotspot
   * @access public
   * @param {object} hotspot hotspot data object
   * @example
   * ShopHotspot.updatePanel()
   * @returns {null} no return value
   * @throws will never throw an error.
   * @since 1.0.0
   */
  updatePanel(hotspot) {
    this.state.hooks.panel.className = this.checkPanel()
      ? this.checkPolarity(hotspot)
        ? 'open-bottom'
        : 'open-top'
      : this.state.hooks.panel.className;
  }
}
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.2</a> on Wed Jul 31 2019 16:28:15 GMT-0400 (Eastern Daylight Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
